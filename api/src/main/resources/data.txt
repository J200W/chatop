use chatop;

DROP TABLE IF EXISTS message;

DROP TABLE IF EXISTS picture;

DROP TABLE IF EXISTS rental;

DROP TABLE IF EXISTS user;

DROP TABLE IF EXISTS role;

CREATE TABLE role
(
    id   INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(20) NOT NULL
);

CREATE TABLE user
(
    id       INT AUTO_INCREMENT PRIMARY KEY,
    name     VARCHAR(250) NOT NULL,
    password VARCHAR(250) NOT NULL,
    role     INT          NOT NULL,
    FOREIGN KEY (role) REFERENCES role (id)
);

CREATE TABLE rental
(
    id          INT AUTO_INCREMENT PRIMARY KEY,
    name        VARCHAR(50)    NOT NULL,
    description VARCHAR(250)   NOT NULL,
    price       DECIMAL(10, 2) NOT NULL,
    surface     DECIMAL(10, 2) NOT NULL,
    owner_id    INT            NOT NULL,
    FOREIGN KEY (owner_id) REFERENCES user (id)
);

ALTER TABLE rental
    ALTER COLUMN owner_id SET DEFAULT 1;

CREATE TABLE picture
(
    id        INT AUTO_INCREMENT PRIMARY KEY,
    url       VARCHAR(250) NOT NULL,
    rental_id INT          NOT NULL,
    FOREIGN KEY (rental_id) REFERENCES rental (id)
);

CREATE TABLE message
(
    id          INT AUTO_INCREMENT PRIMARY KEY,
    content     VARCHAR(250) NOT NULL,
    sender_id   INT          NOT NULL,
    receiver_id INT          NOT NULL,
    rental_id   INT          NOT NULL,
    FOREIGN KEY (sender_id) REFERENCES user (id),
    FOREIGN KEY (receiver_id) REFERENCES user (id),
    FOREIGN KEY (rental_id) REFERENCES rental (id)
);

INSERT INTO role (name)
VALUES ('ADMIN'),
       ('USER');

INSERT INTO user (name, password, role)
VALUES ('dbuser', '$2y$10$.qkbukzzX21D.bqbI.B2R.tvWP90o/Y16QRWVLodw51BHft7ZWbc.', 2),
       ('dbadmin', '$2y$10$kp1V7UYDEWn17WSK16UcmOnFd1mPFVF6UkLrOOCGtf24HOYt8p1iC', 1);

INSERT INTO rental (name, description, price, surface, owner_id)
VALUES ('The District', 'Appartement 1 description', 500, 50, 2),
       ('The Terraces at Spring Grove', 'Appartement 2 description', 600, 60, 2),
       ('Parkside Oasis', 'Appartement 3 description', 700, 70, 2),
       ('Zentopia', 'Appartement 4 description', 800, 80, 2),
       ('Seaside Bluffs', 'Appartement 5 description', 900, 90, 2),
       ('Central Vantage', 'Appartement 6 description', 1000, 100, 2);

INSERT INTO picture (url, rental_id)
VALUES ('https://via.placeholder.com/350', 1),
       ('https://via.placeholder.com/350', 2),
       ('https://via.placeholder.com/350', 3),
       ('https://via.placeholder.com/350', 4),
       ('https://via.placeholder.com/350', 5),
       ('https://via.placeholder.com/350', 6);

INSERT INTO message (content, sender_id, receiver_id, rental_id)
VALUES ('I am interested in your appartment', 2, 1, 1),
       ('I am interested in your appartment', 2, 1, 2),
       ('I am interested in your appartment', 2, 1, 3),
       ('I am interested in your appartment', 2, 1, 4),
       ('I am interested in your appartment', 2, 1, 5),
       ('I am interested in your appartment', 2, 1, 6);

-- Path: api/src/main/resources/application.properties